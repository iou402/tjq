require=function e(o,i,n){function t(s,a){if(!i[s]){if(!o[s]){var r="function"==typeof require&&require;if(!a&&r)return r(s,!0);if(c)return c(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[s]={exports:{}};o[s][0].call(h.exports,function(e){var i=o[s][1][e];return t(i?i:e)},h,h.exports,e,o,i,n)}return i[s].exports}for(var c="function"==typeof require&&require,s=0;s<n.length;s++)t(n[s]);return t}({dian:[function(e,o,i){"use strict";cc._RFpush(o,"4358f3E93FJlIBKU46lQOSf","dian"),cc.Class({"extends":cc.Component,properties:{x:0,y:0},onLoad:function(){},init:function(e,o,i){this.node.setPosition(e,o),this.x=e,this.y=o,this.index=i,console.log("init dian",i)},onclick:function(e){console.log(this.x,this.y),cc.qiChoose&&cc.cli.move(cc.qiChoose.index,this.index)}}),cc._RFpop()},{}],qz:[function(e,o,i){"use strict";cc._RFpush(o,"76b12ERTVdHHr7yWGDqqK9B","qz"),cc.Class({"extends":cc.Component,properties:{belong:0,black:cc.SpriteFrame,white:cc.SpriteFrame,index:0,newPos:[]},init:function(e,o,i,n,t){this.belong=e,this.node.setPosition(o,i),t?this.node.getChildByName("qz").getComponent(cc.Sprite).spriteFrame=this.white:this.node.getChildByName("qz").getComponent(cc.Sprite).spriteFrame=this.black,this.index=n},upBelong:function(e,o){this.belong=e,o?this.node.getChildByName("qz").getComponent(cc.Sprite).spriteFrame=this.white:this.node.getChildByName("qz").getComponent(cc.Sprite).spriteFrame=this.black},uppos:function(e,o){this.index=o,this.newPos=e,cc.qiChoose=null,this.node.getChildByName("tips").active=!1},onLoad:function(){},onclick:function(e){cc.vv.op==cc.myInfo.id&&this.belong==cc.myInfo.id&&(cc.qiChoose&&(cc.qiChoose.node.getChildByName("tips").active=!1),this.node.getChildByName("tips").active=!0,cc.qiChoose=this)},update:function(e){if(this.newPos.hasOwnProperty("x")){var o=cc.moveTo(1,cc.p(this.newPos.x,this.newPos.y));this.node.runAction(cc.sequence(o,cc.blink(3,5)))}this.newPos=[]}}),cc._RFpop()},{}],socket:[function(e,o,i){"use strict";cc._RFpush(o,"fdf0dBEOBZGj4TYoPaYA6UN","socket"),cc.Class({"extends":cc.Component,statics:{ip:"",cli:null,handlers:{},data:null,callBack:null,connect:function(){console.log("init connect",this.data);var e=this;this.cli=new WebSocket(this.ip),this.cli.onopen=function(o){console.log("Client onopen"),e.data&&(console.log("send data:",e.data),e.cli.send(e.data),e.data=null)},this.cli.onmessage=function(o){var i=JSON.parse(o.data.trimRight("\r\n"));console.log("Client received a message",i),e.callback(i)},this.cli.onclose=function(o){e.cli=null,console.log("Client notified socket has closed",o),e.connect()},this.cli.onerror=function(o){e.cli=null,console.log("Client notified socket has onerror",o.data)}},send:function(e){return e=JSON.stringify(e)+"\r\n",this.cli&&this.cli.readyState===WebSocket.OPEN?(this.cli.send(e),void console.log("send data:",e)):(this.data=e,void(null===this.cli&&this.connect()))},login:function(){var e={cmd:1,data:{mapId:1,mid:cc.myInfo.id}};this.send(e)},move:function(e,o){var i={cmd:2,data:{pos1:e,pos2:o}};this.send(i)}}}),cc._RFpop()},{}],tjqroom:[function(e,o,i){"use strict";cc._RFpush(o,"b61d0+6SAdMHrcV9F+noaX+","tjqroom");e("dian"),e("qz");cc.Class({"extends":cc.Component,properties:{other:cc.Node,myself:cc.Node,qipan:cc.Node,dian:cc.Prefab,qi:cc.Prefab},onLoad:function(){var o=this;cc.vv=cc.aQi={},this.drawXian(),this.drawDian(),cc.cli=e("socket"),cc.cli.ip="ws://59.110.154.2:6801/",cc.cli.callback=function(e){o.onRecv(e)};var i=e("user");cc.myInfo=new i,cc.myInfo.id=parseInt(100*Math.random()+1,10),cc.cli.login()},onRecv:function(o){if(o&&o.cmd){var i=o.data;switch(o.cmd){case 11:break;case 12:if(cc.myInfo.id==i.mid)cc.myInfo.init(i),this.setSeat(1,i);else{var n=e("user");cc.otherInfo=new n,cc.otherInfo.init(i),this.setSeat(2,i)}break;case 13:for(var t=0;t<i.info.length;t++)this.initQi(i.info[t]);break;case 14:cc.vv.op=i.op,this.node.getChildByName("optext").getComponent(cc.Label).string=cc.vv.op==cc.myInfo.id?"轮到你操作了":"对方思考中",this.node.getChildByName("optext").active=!0;break;case 15:this.node.getChildByName("optext").active=!1,cc.aQi[i.pos1]?(cc.aQi[i.pos2]=cc.aQi[i.pos1],cc.aQi[i.pos1].getComponent("qz").uppos(this.getPosXY(this.posToXY(i.pos2)),i.pos2),cc.aQi[i.pos1]=null):console.log("棋子不存在 ");break;case 16:for(var t=0;t<i.info.length;t++)this.chi(i.mid,i.info[t]);break;case 17:this.node.getChildByName("optext").getComponent(cc.Label).string=i.win==cc.myInfo.id?"哈哈， 老子就是牛气, 赢了 ":"少年，还需要多吃点呀，输了 ",this.node.getChildByName("optext").active=!0}}},chi:function(e,o){var i=e==cc.myInfo.id?cc.myInfo:cc.otherInfo,n="white"==i.userInfo.role;console.log("chi",e,o,n,i.userInfo.role);for(var t=0;t<o.cpos.length;t++){var c=o.cpos[t];cc.aQi[c]&&cc.aQi[c].getComponent("qz").upBelong(e,n)}},drawXian:function(){var e=150,o=this.qipan.getChildByName("xian").getComponent(cc.Graphics);o.lineJoin=cc.Graphics.LineJoin.ROUND,o.moveTo(-2*e,2*e),o.lineTo(2*e,2*e),o.lineTo(2*e,-2*e),o.lineTo(-2*e,-2*e),o.lineTo(-2*e,2*e),o.lineTo(2*e,-2*e),o.moveTo(2*e,2*e),o.lineTo(-2*e,-2*e),o.moveTo(-2*e,1*e),o.lineTo(2*e,1*e),o.moveTo(-2*e,-1*e),o.lineTo(2*e,-1*e),o.moveTo(-2*e,0),o.lineTo(2*e,0),o.moveTo(1*e,-2*e),o.lineTo(1*e,2*e),o.moveTo(-1*e,-2*e),o.lineTo(-1*e,2*e),o.moveTo(0,-2*e),o.lineTo(0,2*e),o.moveTo(0,-2*e),o.lineTo(2*e,0),o.lineTo(0,2*e),o.lineTo(-2*e,0),o.lineTo(0,-2*e),o.stroke()},drawDian:function(){var e,o,i=this.qipan.getChildByName("xian").getComponent(cc.Graphics);i.fillColor=cc.color(0,0,0);for(var n=0;n<25;n++){var t=this.getPosXY(this.iToXY(n));e=t.x,o=t.y,i.circle(e,o,6),i.circle(e,o,3);var c=cc.instantiate(this.dian);c.parent=this.qipan,c.getComponent("dian").init(e,o,this.getPos(n))}i.stroke()},initQi:function(e){var o=e.chess,i=e.mid,n=i==cc.myInfo.id?cc.myInfo:cc.otherInfo;n.userInfo.role=e.role;for(var t=0;t<o.length;t++){var c=cc.instantiate(this.qi),s=this.getPosXY(this.posToXY(o[t]));c.parent=this.qipan,c.getComponent("qz").init(i,s.x,s.y,o[t],"white"==e.role),cc.aQi[o[t]]=c}},posToXY:function(e){var o=(65280&e)>>8,i=255&e;return{x:o-1,y:i-1}},iToXY:function(e){var o=parseInt(e/5),i=e%5;return{x:o,y:i}},getPos:function(e){var o=this.iToXY(e);return o.x+1<<8|o.y+1},getPosXY:function(e){var o=150,i=e.x*o-2*o,n=e.y*o-2*o;return{x:i,y:n}},setSeat:function(e,o){var i=1==e?this.myself:this.other;i.active=!0,i.getChildByName("mick").getComponent(cc.Label).string=o.mick,o.micon&&cc.loader.load(o.micon,function(e,o){var n=new cc.SpriteFrame(o,cc.Rect(0,0,135,135));i.getChildByName("micon").getComponent(cc.Sprite).spriteFrame=n})},update:function(e){}}),cc._RFpop()},{dian:"dian",qz:"qz",socket:"socket",user:"user"}],user:[function(e,o,i){"use strict";cc._RFpush(o,"9af1bqrw/ZMua1DLqD/JrAP","user"),cc.Class({"extends":cc.Component,properties:{id:null,userInfo:{"default":{}}},init:function(e){for(var o in e)this.userInfo[o]=e[o]}}),cc._RFpop()},{}]},{},["dian","qz","socket","tjqroom","user"]);